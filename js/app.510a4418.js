(function(e){function t(t){for(var a,o,c=t[0],u=t[1],s=t[2],b=0,m=[];b<c.length;b++)o=c[b],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&m.push(r[o][0]),r[o]=0;for(a in u)Object.prototype.hasOwnProperty.call(u,a)&&(e[a]=u[a]);i&&i(t);while(m.length)m.shift()();return l.push.apply(l,s||[]),n()}function n(){for(var e,t=0;t<l.length;t++){for(var n=l[t],a=!0,c=1;c<n.length;c++){var u=n[c];0!==r[u]&&(a=!1)}a&&(l.splice(t--,1),e=o(o.s=n[0]))}return e}var a={},r={app:0},l=[];function o(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=a,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)o.d(n,a,function(t){return e[t]}.bind(null,a));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/VueBoardgamegeekBoard/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],u=c.push.bind(c);c.push=t,c=c.slice();for(var s=0;s<c.length;s++)t(c[s]);var i=u;l.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"0c36":function(e,t,n){},"2e51":function(e,t,n){"use strict";n("0c36")},"3f66":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("7a23"),r={key:0},l=Object(a["g"])(" BoardGameGeek - Username"),o=Object(a["f"])("br",null,null,-1),c=Object(a["f"])("small",null,[Object(a["g"])(" Enter your BGG username and submit. "),Object(a["f"])("br")],-1),u=["disabled"],s={key:1,class:"flex mb"},i=["href"];function b(e,t,n,b,m,f){var d=Object(a["n"])("Board");return Object(a["j"])(),Object(a["e"])(a["a"],null,[m.showForm?(Object(a["j"])(),Object(a["e"])("div",r,[Object(a["f"])("label",null,[l,o,Object(a["r"])(Object(a["f"])("input",{"onUpdate:modelValue":t[0]||(t[0]=function(e){return m.username=e}),onKeyup:t[1]||(t[1]=Object(a["s"])((function(){return f.submit&&f.submit.apply(f,arguments)}),["enter"])),autocorrect:"off",autocapitalize:"off",spellcheck:"false"},null,544),[[a["q"],m.username]]),c]),Object(a["f"])("label",null,[Object(a["f"])("button",{type:"button",onClick:t[2]||(t[2]=function(){return f.submit&&f.submit.apply(f,arguments)}),disabled:!m.username}," Submit ",8,u)])])):(Object(a["j"])(),Object(a["e"])("div",s,[f.permalink?(Object(a["j"])(),Object(a["e"])("a",{key:0,class:"button",href:f.permalink},"Permalink",8,i)):Object(a["d"])("",!0),Object(a["f"])("button",{type:"button",onClick:t[3]||(t[3]=function(){return f.reset&&f.reset.apply(f,arguments)})},"Reset")])),m.submittedUsername?(Object(a["j"])(),Object(a["c"])(d,{key:2,username:m.submittedUsername},null,8,["username"])):Object(a["d"])("",!0)],64)}n("d3b7"),n("3ca3"),n("ddb0"),n("9861"),n("ac1f"),n("841c"),n("2b3d"),n("4de4"),n("b0c0");var m=function(e){return Object(a["l"])("data-v-564a0184"),e=e(),Object(a["k"])(),e},f={key:0,class:"loading"},d=Object(a["g"])(" Loading board for "),j=Object(a["g"])("... "),p={key:1,class:"board"},O={key:0},y={key:0,class:"mb"},g={class:"flex mb"},h={class:"filter"},v={class:"select"},w=["label"],k=["value"],P={class:"shelf"},B={key:1},A=m((function(){return Object(a["f"])("h1",null,"Whoops!",-1)})),C=m((function(){return Object(a["f"])("p",null,"You don't have any games in your collection.",-1)})),x=[A,C];function L(e,t,n,r,l,o){var c=Object(a["n"])("Game");return Object(a["j"])(),Object(a["e"])("div",null,[l.loaded?Object(a["d"])("",!0):(Object(a["j"])(),Object(a["e"])("div",f,[d,Object(a["f"])("i",null,Object(a["o"])(n.username),1),j])),l.loaded?(Object(a["j"])(),Object(a["e"])("div",p,[l.collection.length>0?(Object(a["j"])(),Object(a["e"])("div",O,[l.showRandomGame?(Object(a["j"])(),Object(a["e"])("div",y,[Object(a["h"])(c,{class:"game",game:l.randomLeastPlayed},null,8,["game"])])):Object(a["d"])("",!0),Object(a["f"])("div",g,[Object(a["f"])("button",{type:"button",onClick:t[0]||(t[0]=function(){return o.reroll&&o.reroll.apply(o,arguments)})},"Random game"),Object(a["f"])("div",h,[Object(a["r"])(Object(a["f"])("input",{"onUpdate:modelValue":t[1]||(t[1]=function(e){return l.filter=e}),autocorrect:"off",autocapitalize:"off",spellcheck:"false",placeholder:"Filter"},null,512),[[a["q"],l.filter,void 0,{trim:!0}]])]),Object(a["f"])("div",v,[Object(a["r"])(Object(a["f"])("select",{"onUpdate:modelValue":t[2]||(t[2]=function(e){return l.sortBy=e})},[(Object(a["j"])(!0),Object(a["e"])(a["a"],null,Object(a["m"])(l.sortOptions,(function(e,t){return Object(a["j"])(),Object(a["e"])("optgroup",{key:t,label:e.name},[(Object(a["j"])(!0),Object(a["e"])(a["a"],null,Object(a["m"])(e.sortOptions,(function(e,t){return Object(a["j"])(),Object(a["e"])("option",{key:t,value:e},Object(a["o"])(e.name),9,k)})),128))],8,w)})),128))],512),[[a["p"],l.sortBy]])])]),Object(a["f"])("div",P,[(Object(a["j"])(!0),Object(a["e"])(a["a"],null,Object(a["m"])(o.collectionSorted,(function(e){return Object(a["j"])(),Object(a["c"])(c,{class:"game",key:e.id,game:e},null,8,["game"])})),128))])])):(Object(a["j"])(),Object(a["e"])("div",B,x))])):Object(a["d"])("",!0)])}n("4e82"),n("fb6a"),n("caad"),n("2532");var S=n("3835"),T=n("1da1"),M=(n("96cf"),n("159b"),n("a630"),n("99af"),n("4fad"),n("07ac"),n("5a0c")),Y=n.n(M),U=100,_="https://www.boardgamegeek.com/xmlapi2/",E="https://boardgamegeek.com/boardgame/",G=Y()(),N={xml:function(e){var t=arguments,n=this;return Object(T["a"])(regeneratorRuntime.mark((function a(){var r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=t.length>1&&void 0!==t[1]?t[1]:null,r||(r=U),a.abrupt("return",fetch(e).then((function(t){if(200===t.status)return t.text();if(202===t.status){var a=new Promise((function(t){setTimeout((function(){t(n.xml(e,r))}),r)}));return r*=2,a}})).then((function(e){return e instanceof Document?e:(new window.DOMParser).parseFromString(e,"text/xml")})));case 3:case"end":return a.stop()}}),a)})))()},collection:function(e){return this.xml("".concat(_,"collection?username=").concat(e,"&own=1&subtype=boardgame&excludesubtype=boardgameexpansion")).then((function(e){var t={};return Array.from(e.getElementsByTagName("item")).forEach((function(e){var n=e.getAttribute("objectid"),a=null;e.getElementsByTagName("thumbnail")[0]&&(a=e.getElementsByTagName("thumbnail")[0].innerHTML),t[n]={id:n,name:e.getElementsByTagName("name")[0].innerHTML,uri:"".concat(E).concat(n),thumbnail:a,playCount:0,lastPlay:null,lastPlayAgo:null,plays:[]}})),t}))},plays:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise((function(r){t.xml("".concat(_,"plays?username=").concat(e,"&own=1&page=").concat(n)).then((function(l){Array.from(l.getElementsByTagName("play")).forEach((function(e){var t=e.getElementsByTagName("item")[0],n=t.getAttribute("objectid");a[n]||(a[n]=[]),a[n].push({date:e.getAttribute("date"),count:parseInt(e.getAttribute("quantity"))})})),l.getElementsByTagName("plays")[0].getAttribute("total")/100-n>0?t.plays(e,n+1,a).then((function(){r(a)})):r(a)}))}))},fetch:function(e){return Promise.all([this.collection(e),this.plays(e)]).then((function(e){var t,n,a=Object(S["a"])(e,2);t=a[0],n=a[1];for(var r=function(){var e=Object(S["a"])(o[l],2),n=e[0],a=e[1],r=t[n];r&&(r.playsByYear={},r.playCount=a.reduce((function(e,t){var n=t.date.substr(0,4);return r.playsByYear[n]?r.playsByYear[n]+=t.count:r.playsByYear[n]=t.count,e+t.count}),0),r.lastPlay=Y()(a[0].date),r.lastPlayAgo=G.diff(r.lastPlay,"day"),r.plays=a)},l=0,o=Object.entries(n);l<o.length;l++)r();return Object.values(t)}))}},R=function(e){return Object(a["l"])("data-v-6d0fe943"),e=e(),Object(a["k"])(),e},F={class:"thumbnail-container"},q=["src"],I={class:"content-container"},V={key:0,class:"ago"},z={key:0},D=Object(a["g"])(" played "),H=R((function(){return Object(a["f"])("strong",null,"today",-1)})),J=[D,H],K={key:1},W=Object(a["g"])(" days ago "),Q={class:"mb flex-grow"},X=["href"],Z={key:0,class:"secondary"},$=R((function(){return Object(a["f"])("br",null,null,-1)})),ee={key:1,class:"plays"},te=R((function(){return Object(a["f"])("br",null,null,-1)})),ne=Object(a["g"])(" this year "),ae=R((function(){return Object(a["f"])("br",null,null,-1)})),re=Object(a["g"])(" last year "),le=R((function(){return Object(a["f"])("br",null,null,-1)})),oe=Object(a["g"])(" total "),ce={key:2,class:"plays-none"},ue=R((function(){return Object(a["f"])("small",null," no plays logged ",-1)})),se=[ue];function ie(e,t,n,r,l,o){return Object(a["j"])(),Object(a["e"])("div",{class:Object(a["i"])(["game",o.classNames])},[Object(a["f"])("div",F,[Object(a["f"])("img",{src:n.game.thumbnail,class:"thumbnail"},null,8,q)]),Object(a["f"])("div",I,[n.game.playCount?(Object(a["j"])(),Object(a["e"])("div",V,[0===n.game.lastPlayAgo?(Object(a["j"])(),Object(a["e"])("span",z,J)):(Object(a["j"])(),Object(a["e"])("span",K,[Object(a["f"])("strong",null,Object(a["o"])(n.game.lastPlayAgo),1),W]))])):Object(a["d"])("",!0),Object(a["f"])("div",Q,[Object(a["f"])("a",{class:Object(a["i"])(["name",{long:o.nameIsLong}]),href:n.game.uri,target:"_blank",rel:"nofollow noopener"},[Object(a["g"])(Object(a["o"])(o.nameMain)+" ",1),o.nameSecondary?(Object(a["j"])(),Object(a["e"])("span",Z,[$,Object(a["g"])(Object(a["o"])(o.nameSecondary),1)])):Object(a["d"])("",!0)],10,X)]),n.game.playCount?(Object(a["j"])(),Object(a["e"])("div",ee,[Object(a["f"])("div",null,[Object(a["f"])("strong",null,Object(a["o"])(o.gameCountThisYear),1),te,ne]),Object(a["f"])("div",null,[Object(a["f"])("strong",null,Object(a["o"])(o.gameCountLastYear),1),ae,re]),Object(a["f"])("div",null,[Object(a["f"])("strong",null,Object(a["o"])(n.game.playCount),1),le,oe])])):(Object(a["j"])(),Object(a["e"])("div",ce,se))])],2)}n("1276");var be=(new Date).getFullYear(),me=function(e,t){var n,a=e.split(/:/);return null!==(n=a[t])&&void 0!==n?n:null},fe={name:"Game",props:{game:{required:!0,type:Object}},data:function(){return{}},computed:{nameMain:function(){return me(this.game.name,0)},nameSecondary:function(){return me(this.game.name,1)},nameIsLong:function(){return this.nameMain.length>25},classNames:function(){var e=[];return null===this.game.lastPlayAgo?e.push("last-played-never"):this.game.lastPlayAgo<=7?e.push("last-played-week"):this.game.lastPlayAgo<=30?e.push("last-played-month"):this.game.lastPlayAgo<=356&&e.push("last-played-year"),e},gameCountThisYear:function(){var e;return null!==(e=this.game.playsByYear[be])&&void 0!==e?e:"-"},gameCountLastYear:function(){var e;return null!==(e=this.game.playsByYear[be-1])&&void 0!==e?e:"-"}}},de=(n("ba7b"),n("6b0d")),je=n.n(de);const pe=je()(fe,[["render",ie],["__scopeId","data-v-6d0fe943"]]);var Oe=pe,ye=function(e,t){return e.name.localeCompare(t.name)},ge=function(e,t,n){return null===e.lastPlayAgo&&null===t.lastPlayAgo||e.lastPlayAgo===t.lastPlayAgo?0:null===e.lastPlayAgo?n?-1:1:null===t.lastPlayAgo?n?1:-1:e.lastPlayAgo<=t.lastPlayAgo?-1:1},he=function(e,t){return null===e.playCount&&null===t.playCount||e.playCount===t.playCount?0:null===e.playCount?1:null===t.playCount||e.playCount>=t.playCount?-1:1},ve=[{name:"by date",sortOptions:[{name:"most recent",sort:function(e,t){var n=ge(e,t);return 0===n?ye(e,t):n}},{name:"least recent",sort:function(e,t){var n=-1*ge(e,t,!0);return 0===n?ye(e,t):n}}]},{name:"by plays",sortOptions:[{name:"most plays",sort:function(e,t){var n=he(e,t);return 0===n?ye(e,t):n}},{name:"least plays",sort:function(e,t){var n=-1*he(e,t);return 0===n?ye(e,t):n}}]}],we={name:"Board",components:{Game:Oe},props:{username:{type:String,required:!0}},data:function(){return{loaded:!1,collection:null,filter:null,sortOptions:ve,sortBy:ve[0].sortOptions[0],showRandomGame:!1,randomLeastPlayed:null}},mounted:function(){var e=this;N.fetch(this.username).then((function(t){e.collection=t,e.loaded=!0}))},methods:{pickLeastPlayed:function(){var e=this.collection,t=null;do{t=e[Math.floor(Math.random()*e.length)]}while(this.randomLeastPlayed===t&&e.length>1);this.randomLeastPlayed=t},reroll:function(){this.showRandomGame=!0,this.pickLeastPlayed()}},computed:{collectionSorted:function(){var e=this;return this.collection.slice().filter((function(t){return!e.filter||t.name.toLowerCase().includes(e.filter.toLowerCase())})).sort(this.sortBy.sort)}}};n("2e51");const ke=je()(we,[["render",L],["__scopeId","data-v-564a0184"]]);var Pe=ke,Be=null,Ae=new URLSearchParams(window.location.search);Ae.has("username")&&(Be=Ae.get("username"));var Ce=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=new URL(window.location),n="username";e?t.searchParams.set(n,e):t.searchParams.delete(n),window.history.pushState({},"",t)},xe={name:"App",components:{Board:Pe},data:function(){var e;return{username:Be,showForm:!Be,submittedUsername:null!==(e=Be)&&void 0!==e?e:null}},computed:{permalink:function(){return this.username?"https://spazzmarticus.github.io/VueBoardgamegeekBoard/?username=".concat(this.username):null}},methods:{reset:function(){this.showForm=!0,this.submittedUsername=null,Ce()},submit:function(){this.showForm=!1,this.submittedUsername=this.username,Ce(this.username)}}};n("ec2f");const Le=je()(xe,[["render",b]]);var Se=Le;Object(a["b"])(Se).mount("#app")},ba7b:function(e,t,n){"use strict";n("f698")},ec2f:function(e,t,n){"use strict";n("3f66")},f698:function(e,t,n){}});
//# sourceMappingURL=app.510a4418.js.map